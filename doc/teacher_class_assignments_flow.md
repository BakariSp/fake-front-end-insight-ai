# 教师端班级作业管理流程文档

## 概述

本文档描述了教师端班级作业管理系统的完整流程，包括作业列表、AI评分分析和逐题审阅功能。

## 功能架构

### 1. 目录结构

```
app/teacher/class/[classId]/assignments/
├── types.ts                              # 类型定义
├── mockData.ts                           # Mock数据
├── assignments.module.css                 # 列表页样式
├── page.tsx                              # 班级作业列表页
├── [assignmentId]/
│   ├── assignmentDetail.module.css       # 详情页样式
│   ├── page.tsx                          # 作业详情页（含AI分析）
│   └── review/
│       ├── review.module.css             # 审阅页样式
│       └── page.tsx                      # 逐题审阅页
```

## 主要功能模块

### 1. 班级作业列表页
**路径**: `/teacher/class/[classId]/assignments`

#### 功能特点：
- **三种作业状态**：
  - 🟡 **Draft（草稿）**: 未发布的作业，可以继续编辑
  - 🔵 **Published（已发布未到期）**: 学生可以提交作业，显示提交进度
  - 🟢 **Graded（已评分）**: AI已完成评分，显示平均分等统计信息

- **统计信息**：
  - 总作业数量
  - 各状态作业数量
  - 提交进度（已提交/总人数）
  - 平均分（已评分作业）

- **操作功能**：
  - 搜索作业（按标题或科目）
  - 按状态筛选（All/Draft/Published/Graded）
  - 编辑草稿作业
  - 监控已发布作业
  - 查看评分结果

### 2. 作业详情与AI分析页
**路径**: `/teacher/class/[classId]/assignments/[assignmentId]`

这是本次实现的核心功能，包含三个主要Tab：

#### Tab 1: Overview（概览）
显示整体统计和成绩分布：

- **关键指标卡片**：
  - 📊 提交数量（已提交/总人数）
  - ⭐ 平均分
  - ⚡ 最高分
  - ⚠️ 最低分

- **分数分布图表**：
  - 可视化柱状图展示不同分数段的学生分布
  - 分数段：90-100, 80-89, 70-79, 60-69, 0-59
  - 显示每个分数段的人数和百分比
  - 不同分数段用不同颜色区分

- **优秀表现**：
  - 列出班级在此次作业中的优点
  - 例如："选择题整体正确率较高，基础知识掌握较好"

#### Tab 2: Analysis（分析）
深度分析题目难度和薄弱点：

**1. 题目难度分析**
- 每道题目的详细统计：
  - 正确率
  - 平均得分
  - 难度等级（Easy/Medium/Hard）
  - 常见错误列表

**2. 薄弱知识点分析**
这是AI分析的重点功能，每个薄弱点包含：
- 📌 **知识点名称**：如"文言文翻译"、"诗歌鉴赏表现手法"
- 👥 **影响范围**：多少学生存在此问题及百分比
- 📝 **问题描述**：详细说明学生在该知识点的具体问题
- 💡 **改进建议**：提供4-5条具体的教学改进建议
- 🔗 **相关题目**：列出涉及此知识点的题目

示例薄弱点：
```
薄弱点：文言文翻译
影响学生：28人（65.1%）
描述：学生在文言文句子翻译时，普遍存在不能准确把握句式特点、
      实词含义理解不到位的问题
建议：
  1. 加强文言实词的积累和运用
  2. 注重特殊句式的识别和翻译方法
  3. 多做翻译练习，注重字字落实
  4. 培养根据上下文推断词义的能力
```

#### Tab 3: Students（学生）
- 显示所有学生的提交列表
- 每个学生卡片包含：
  - 学生头像和姓名
  - 提交时间
  - AI评分
  - "Review"按钮进入审阅界面

- **"Start Review"按钮**：开始逐个审阅学生作业

### 3. 逐题审阅界面
**路径**: `/teacher/class/[classId]/assignments/[assignmentId]/review`

这是教师修改AI评分和添加评语的核心界面。

#### 界面布局：

**左侧边栏（Sticky）**：
- **学生信息卡片**：
  - 学生头像（大尺寸，带蓝色边框）
  - 姓名
  - 提交时间
  - AI分数 vs 教师分数对比
  - 总分

- **导航按钮**：
  - Previous Student（上一个学生）
  - Next Student（下一个学生）

- **保存按钮**：
  - 只有修改后才激活
  - 显示"Save Changes"或"No Changes"

**主内容区**：

每道题目一个卡片，包含：

1. **题目头部**：
   - 题号（Q1, Q2...）
   - 题型标签（Multiple Choice / Fill in the Blank / Essay）
   - 分值

2. **题目内容**：
   - 完整的题目文本

3. **学生答案展示**：
   根据题型不同有不同的展示方式：
   
   - **选择题**：
     - 显示学生选择的选项（正确显示绿色，错误显示红色）
     - 如果错误，显示正确答案
   
   - **填空题**：
     - 每个空格单独显示
     - 标注正确/错误
     - 错误时显示可接受的正确答案
   
   - **问答题**：
     - 显示完整答案文本
     - 显示关键词标签（帮助教师快速判断是否包含关键点）

4. **AI评估区域**（蓝色渐变背景）：
   - AI图标
   - AI分数
   - AI评语（详细的评分理由）

5. **教师评估区域**（黄色渐变背景）：
   - 教师图标
   - **分数输入框**：
     - 数字输入，范围0-题目满分
     - 默认值为AI分数
     - 修改后自动计算总分
   
   - **评语文本框**：
     - 多行文本输入
     - 占位符："Add your feedback for the student..."
     - 教师可以添加针对性的建议和鼓励

#### 导航和进度：

**顶部进度条**：
- 显示当前审阅进度："Reviewing: 1 of 43"
- 百分比："95% Complete"
- 可视化进度条

**底部操作栏**（Sticky）：
- Previous / Save & Continue / Next
- 居中显示，方便操作

#### 数据保存逻辑：
- 实时编辑，有修改时标记为"有未保存更改"
- 切换学生前提示保存
- 保存后更新提交状态为"teacher_graded"
- 计算最终总分（教师分数优先，否则使用AI分数）

## 数据模型

### 主要类型：

```typescript
// 作业状态
type AssignmentStatus = 'draft' | 'published' | 'graded';

// 题目类型
type QuestionType = 'choice' | 'fill-blank' | 'essay';

// 班级作业
interface ClassAssignment {
  id: string;
  title: string;
  subject: string;
  status: AssignmentStatus;
  questions: Question[];
  stats: AssignmentStats;
  // ...
}

// 学生提交
interface StudentSubmission {
  studentId: string;
  studentName: string;
  answers: StudentAnswer[];
  aiScore?: number;
  teacherScore?: number;
  // ...
}

// 班级分析
interface ClassAnalytics {
  scoreDistribution: ScoreRange[];
  questionDifficulty: QuestionDifficultyAnalysis[];
  weakPoints: WeakPoint[];
  strengths: string[];
}
```

## Mock数据示例

创建了完整的Mock数据，包括：

1. **三种状态的作业**：
   - Draft: "第三单元语文综合测试"
   - Published: "期中复习：现代文阅读理解"
   - Graded: "第二单元综合测试：文言文与古诗词"（完整的评分数据）

2. **学生提交数据**：
   - 5个学生的完整答案
   - AI评分和评语
   - 不同分数段（52-94分）

3. **班级分析数据**：
   - 分数分布（5个区间）
   - 6道题目的难度分析
   - 3个主要薄弱点及改进建议
   - 4条优秀表现

## 用户流程

### 教师使用流程：

1. **进入班级作业列表**
   - 路径：`/teacher/class/[classId]/assignments`
   - 查看所有作业及其状态
   - 筛选/搜索作业

2. **查看已评分作业的详情**
   - 点击"View Results"按钮
   - 查看Overview Tab了解整体情况
   - 查看Analysis Tab了解题目难度和薄弱点
   - 阅读AI给出的教学建议

3. **开始审阅学生作业**
   - 点击"Start Review"按钮
   - 进入逐题审阅界面

4. **审阅第一个学生**
   - 查看学生信息和AI评分
   - 逐题查看：
     - 题目内容
     - 学生答案
     - AI评分和评语
   - 修改AI评分（如需要）
   - 添加教师评语
   - 点击"Save & Continue"

5. **继续审阅其他学生**
   - 自动跳转到下一个学生
   - 重复审阅流程
   - 进度条显示完成情况

6. **完成审阅**
   - 审阅完所有学生后返回详情页
   - 查看最终的成绩分布
   - 根据薄弱点分析调整教学计划

## 技术特点

### 1. UI/UX设计
- 清晰的视觉层级
- 丰富的色彩编码（成功=绿色，警告=黄色，信息=蓝色，错误=红色）
- 流畅的交互动画
- Sticky定位的关键元素（侧边栏、进度条、操作栏）
- 响应式设计

### 2. 数据可视化
- 分数分布柱状图
- 进度条和百分比显示
- 题目难度标签（Easy/Medium/Hard）
- 统计卡片

### 3. 智能辅助
- AI自动评分
- AI生成详细评语
- 识别常见错误
- 分析薄弱知识点
- 提供教学建议

### 4. 教师干预
- 可以修改AI评分
- 可以添加个性化评语
- 保留AI评分作为参考
- 最终分数由教师决定

## 样式主题

使用了一致的设计语言：

- **主色调**：
  - Primary Blue: `var(--primary-blue)`
  - Success Green: `var(--success-green)`
  - Warning Yellow/Orange: `var(--warning-yellow)`, `var(--warning-orange)`
  - Error Red: `var(--error-red)`

- **间距规范**：
  - 小间距：8px, 12px
  - 中间距：16px, 20px, 24px
  - 大间距：32px

- **圆角**：
  - 小圆角：6px, 8px
  - 中圆角：10px, 12px
  - 大圆角：20px（标签）

- **阴影**：
  - Hover: `0 2px 8px rgba(..., 0.1)`
  - Focus: `0 4px 12px rgba(..., 0.1)`

## 扩展建议

未来可以添加的功能：

1. **批量操作**：
   - 批量修改某道题的分数
   - 批量添加评语模板

2. **导出功能**：
   - 导出成绩单（PDF/Excel）
   - 导出分析报告

3. **对比功能**：
   - 对比不同班级的表现
   - 对比历史作业的成绩趋势

4. **通知功能**：
   - 审阅完成后通知学生
   - 推送薄弱点改进资源

5. **协作功能**：
   - 多位教师共同审阅
   - 教师间分享评语模板

## 测试建议

1. **功能测试**：
   - 测试三种作业状态的切换
   - 测试分数修改和计算逻辑
   - 测试导航和保存功能

2. **UI测试**：
   - 测试不同屏幕尺寸的响应式布局
   - 测试长文本的显示效果
   - 测试空状态和加载状态

3. **数据测试**：
   - 测试大量学生（100+）的性能
   - 测试长答案的显示
   - 测试特殊字符和格式

## 总结

本系统实现了一个完整的教师端作业管理流程，从查看作业列表、分析班级表现、到逐个审阅学生作业。AI提供了智能辅助，但保留了教师的最终判断权。界面设计清晰、操作流畅，能够有效提高教师的工作效率。

特别是**薄弱点分析**功能，通过AI识别班级共性问题并提供改进建议，可以帮助教师更有针对性地调整教学策略，这是本系统的一大亮点。

