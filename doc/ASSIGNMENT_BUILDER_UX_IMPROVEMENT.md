# Assignment Builder UX 重大改进

## 📅 更新日期
2025-11-10 (第二次更新)

## 🎯 改进内容

根据用户反馈，进行以下UX重大改进：

### 1. **Google Form 风格的题目编辑** 🎨

**之前**：题目编辑在右侧Inspector侧边栏  
**现在**：题目编辑直接在画布中央，类似Google Form

#### 使用方法
- **双击任务卡片** → 进入编辑模式
- **点击"编辑详情"** → 进入编辑模式  
- **点击"收起"** → 返回列表模式

### 2. **选择题直接编辑** 📝

在展开模式下，可以直接：
- ✅ 选择题型（单选/多选/判断）
- ✅ 添加/删除选项
- ✅ 勾选正确答案
- ✅ 填写答案解析
- ✅ 设置分值

### 3. **填空题直接编辑** ✏️

在展开模式下，可以直接：
- ✅ 输入题干内容
- ✅ 使用 `{{1}}` `{{2}}` 标记空格
- ✅ 为每个空格设置答案
- ✅ 设置分值

### 4. **子题目支持** 📋

新增数据结构支持一个大题包含多个小题（子题目）

---

## 🖼️ 界面对比

### 折叠模式（列表视图）

```
┌────────────────────────────────────────────────────────┐
│ 1  [📝 选择题]  一元二次方程的解法      10分   [⋯]   │
│                                                        │
│    [输入] [自动批改]                                   │
└────────────────────────────────────────────────────────┘
```

**功能**：
- 快速浏览所有任务
- 拖拽调整顺序
- 查看基本信息

### 展开模式（编辑视图） - Google Form 风格

```
┌─────────────────────────────────────────────────────────────────┐
│ [收起]                                    [复制]  [删除]        │
├─────────────────────────────────────────────────────────────────┤
│                                                                   │
│ 一元二次方程的解法                           [单选题▼]         │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━            │
│ 请解方程 x² - 3x + 2 = 0                                        │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━            │
│                                                                   │
│ ○ A. x = 1, x = 2                                          [×]  │
│ ○ B. x = -1, x = -2                                        [×]  │
│ ○ C. x = 0, x = 3                                          [×]  │
│ ● D. x = 无实数解                                          [×]  │
│                                                                   │
│ + 添加选项                                                       │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━            │
│ 答案解析（可选）                                                │
│ [通过配方法或求根公式可得...]                                   │
│                                                                   │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━            │
│ 分值: [10]                               [更多设置 →]           │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📝 详细功能说明

### 选择题编辑

#### 1. **题型切换**
```
[单选题▼]  ← 下拉菜单
  - 单选题 (只能选一个)
  - 多选题 (可选多个)
  - 判断题 (正确/错误)
```

#### 2. **选项编辑**
```
☑ A. [在这里输入选项内容                    ] [×]
○ B. [在这里输入选项内容                    ] [×]
○ C. [在这里输入选项内容                    ] [×]
```

- **勾选框**：设置正确答案
- **输入框**：编辑选项文字
- **[×] 按钮**：删除选项（至少保留2个）

#### 3. **添加选项**
```
+ 添加选项  ← 点击添加新选项
```

#### 4. **答案解析**
```
答案解析（可选）
[为学生提供详细的解题思路和解析...]
```

### 填空题编辑

#### 1. **题目内容**
```
使用 {{1}} {{2}} 标记空格位置

[水的化学式是 {{1}}，由 {{2}} 和 {{3}} 组成。]
```

#### 2. **空格答案**
```
空格 1: [H2O | 水                           ] 5分
空格 2: [氢 | H                             ] 3分
空格 3: [氧 | O                             ] 2分
```

- 系统自动识别 `{{数字}}`
- 自动生成空格答案输入框
- 支持多个正确答案（用 | 分隔）

---

## 🚀 使用流程

### 创建选择题（完整流程）

1. **添加任务**
   - 从左侧任务库点击"选择题"

2. **进入编辑模式**
   - 双击任务卡片
   - 或点击 ⋯ → "编辑详情"

3. **编辑题干**
   - 修改标题："一元二次方程的解法"
   - 填写说明："请解方程 x² - 3x + 2 = 0"

4. **选择题型**
   - 从右上角下拉菜单选择"单选题"

5. **编辑选项**
   - 点击选项文本框输入内容
   - 勾选正确答案的单选框
   - 点击 [×] 删除不需要的选项
   - 点击"+ 添加选项"增加选项

6. **添加解析**（可选）
   - 在答案解析框输入："通过配方法或求根公式可得"

7. **设置分值**
   - 底部输入框修改分值

8. **完成**
   - 点击"收起"返回列表视图

### 创建填空题（完整流程）

1. **添加任务**
   - 从左侧任务库点击"填空题"

2. **进入编辑模式**
   - 双击任务卡片

3. **编辑题干**
   - 修改标题："化学式填空"
   - 输入内容：`水的化学式是 {{1}}，由 {{2}} 和 {{3}} 组成。`

4. **设置答案**
   - 空格1：输入 `H2O | 水`
   - 空格2：输入 `氢 | H`
   - 空格3：输入 `氧 | O`

5. **调整分值**
   - 系统自动分配分值，可手动调整

6. **完成**
   - 点击"收起"

---

## 🆕 子题目功能

### 数据结构

```typescript
interface Task {
  // ... 其他字段
  
  // 子题目支持
  subQuestions?: SubQuestion[];
  hasSubQuestions?: boolean;
}

interface SubQuestion {
  id: string;
  order: number;
  title: string;
  points: number;
  type: 'quiz' | 'fill-blank' | 'essay';
  quizConfig?: QuizConfig;
  fillBlankConfig?: FillBlankConfig;
}
```

### 使用场景

**场景1：阅读理解**
- 主题：阅读理解 - 《背影》
- 子题1：选择题 - 作者是谁？
- 子题2：填空题 - 文章写于___年
- 子题3：简答题 - 谈谈你的理解

**场景2：数学综合题**
- 主题：函数综合应用
- 子题1：填空题 - 求函数的定义域
- 子题2：选择题 - 判断单调性
- 子题3：解答题 - 画出函数图像

### 未来实现

子题目功能的UI实现将在下一个版本中完成，包括：
- 添加子题目按钮
- 子题目列表展示
- 子题目独立编辑
- 总分自动计算

---

## 🎨 设计原则

### 1. **中心化编辑**
- 题目内容在屏幕中央，视觉焦点明确
- 参考Google Form的设计理念
- 减少左右移动视线

### 2. **实时反馈**
- 输入即时生效
- 空格自动识别
- 分值自动计算

### 3. **渐进式显示**
- 列表模式：显示摘要信息
- 编辑模式：显示完整表单
- 减少认知负担

### 4. **一致性**
- 所有题型使用相同的编辑模式
- 统一的工具栏和底部配置栏
- 熟悉的交互模式

---

## 📊 代码统计

### 新增文件
- `TaskCardExpanded.tsx` - 展开视图组件
- `TaskCardExpanded.module.css` - 展开视图样式

### 修改文件
- `types.ts` - 添加SubQuestion类型
- `TaskCard.tsx` - 集成展开/折叠模式

### 代码行数
- 新增: ~600 行
- 修改: ~50 行

---

## ✅ 验收清单

- [x] 展开模式UI完成
- [x] 选择题在中央编辑
- [x] 填空题在中央编辑
- [x] 题型切换功能
- [x] 添加/删除选项
- [x] 双击展开
- [x] 收起按钮
- [x] 子题目数据结构
- [x] 无Linter错误
- [x] 样式符合设计

---

## 🔄 交互说明

### 键盘快捷键

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 展开任务 | 双击 | 进入编辑模式 |
| 收起任务 | ESC | 返回列表模式 |
| 删除选项 | × 按钮 | 至少保留2个选项 |

### 鼠标交互

| 元素 | 操作 | 结果 |
|------|------|------|
| 任务卡片 | 单击 | 选中（Inspector显示） |
| 任务卡片 | 双击 | 展开编辑 |
| ⋯ 菜单 | 点击 | 显示快捷操作 |
| 正确答案 | 勾选 | 设置正确答案 |
| + 添加选项 | 点击 | 添加新选项 |

---

## 📖 相关文档

- [ASSIGNMENT_BUILDER_GUIDE.md](./ASSIGNMENT_BUILDER_GUIDE.md) - 完整使用指南
- [ASSIGNMENT_BUILDER_UPDATE.md](./ASSIGNMENT_BUILDER_UPDATE.md) - 第一次更新说明
- [task_builder.md](./task_builder.md) - 原始需求

---

## 💡 未来规划

### 短期（下个版本）
- [ ] 子题目UI实现
- [ ] 题目预览增强
- [ ] 拖拽优化
- [ ] 键盘快捷键完善

### 中期
- [ ] 题库标签系统
- [ ] 题目难度评级
- [ ] 批量编辑
- [ ] 题目导出/导入

### 长期
- [ ] 协作编辑
- [ ] 版本历史
- [ ] AI智能推荐
- [ ] 数据分析

---

**更新完成时间**: 2025-11-10  
**版本**: v1.2.0  
**重要程度**: ⭐⭐⭐⭐⭐  
**状态**: ✅ 核心功能完成，子题目UI待实现

